---
import GoToArrowIcon from "@icons/GoToArrow.astro";
import MapPinIcon from "@icons/MapPin.astro";
import { LocationPhone } from "@components/react/LocationPhone";
import {
  Leaflet,
  Marker,
  Popup,
} from "astro-leaflet";
---

<section id="ubicacion" class="relative z-10 flex lg:flex-row flex-col justify-center items-center gap-8 lg:gap-0 lg:h-[90vh] py-16 lg:py-0 bg-linear-to-b from-gray-50 to-white">
  <div class="flex flex-col justify-center items-center lg:w-1/2 w-full lg:h-full p-6 lg:p-0 reveal">
    <span class="flex flex-col items-center gap-6 w-full lg:w-2/3 text-center lg:text-left">
      <div>
        <h3 class="w-full font-bold text-3xl mb-2 text-gray-900">Encuéntranos</h3>
         <p class="text-gray-600">Estamos ubicados al lado de la plazuela de Capacachi y la Capilla Virgen del Carmen</p>
      </div>
     
      <div class="group relative flex flex-row items-center gap-3 bg-white hover:bg-white/80 px-5 py-4 border border-gray-200 hover:border-blue-400 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 w-full max-w-sm">
        <div class="bg-blue-50 p-2 rounded-full">
           <MapPinIcon className="w-8 h-8 text-blue-500" />
        </div>
        <a
          target="_blank"
          href="https://www.google.com/maps/search/?api=1&query=-17.38332961564672,-66.22185454484892"
          class="flex-1"
        >
          <b class="text-lg block text-gray-800">Dirección</b>
          <p class="text-sm text-gray-500">Av. 16 de Julio y D'orbigny, Zona Capacachi <br/> Colcapirhua - Cochabamba</p>
        </a>
        <GoToArrowIcon className="top-2 group-hover:top-3 right-2 group-hover:right-3 absolute w-5 h-5 text-blue-400 opacity-0 group-hover:opacity-100 transition-all duration-300" />
      </div>

      <div class="flex flex-row gap-4 w-full max-w-sm">
        <LocationPhone client:load />
        
        <div class="flex-1 flex flex-col items-center justify-center p-4 bg-white border border-gray-100 rounded-xl shadow-sm">
           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-blue-500 mb-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="font-bold text-gray-800">Horarios</span>
          <span class="text-sm text-gray-500">Lun-Vie: 8:00-16:00</span>
        </div>
      </div>

    </span>
  </div>

  <div class="z-10 px-6 lg:p-5 w-full lg:w-1/2 h-80 lg:h-full shadow-inner lg:shadow-none reveal reveal-delay-200">
    <div class="w-full h-full rounded-2xl overflow-hidden shadow-lg lg:shadow-none border border-gray-200 lg:border-none">
      <Leaflet
        id="map-quick-start"
        style={{ height: "100%", width: "100%" }}
        options={{ center: [-17.383369, -66.2218407], zoom: 16 }}
      >
        <Marker latlng={[-17.383369, -66.2218407]}>
          <Popup content="Odontología especializada <br/> Dr. Alexander Ojalvo" open />
        </Marker>
      </Leaflet> 
    </div>
  </div>
</section>

<script>
  import { getMapFromId } from "astro-leaflet"
  import L from 'leaflet'

  window.addEventListener('load', () => {
    const map = getMapFromId('map-quick-start')
    if (map) {
      var popup = L.popup();
      function onMapClick(e: any) {
        popup
        .setLatLng(e.latlng)
        .setContent("You clicked the map at " + e.latlng.toString())
        .openOn(map!);
      }
      map.on('click', onMapClick);
    }
  })
</script>